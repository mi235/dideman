{% extends "salary/base.html" %}
{% load i18n admin_static %}
{% load base_site %}
{% block extrastyle %}{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static "admin/css/forms.css" %}" />
<script src="{% static "jquery-ui/js/jquery-1.7.2.min.js" %}"></script>
<script>
$(function() {
    $("#totalreports")
      .change(function() {
        $("#emp-action").val($(this).val()); 
        $("#edit-form").submit();
    });
});
</script>

{% endblock %}
{% block title %}
Δ.Δ.Ε. {% get_setting 'dide_place'  %}
{% endblock %}


{% block content %}
<div id="content-main">
  <h1>Σύστημα Μισθοδοσίας</h1>
    <form action="{{ app_path }}" method="post" id="edit-form">{% csrf_token %}
      <input type="hidden" id="emp-action" name="emp-action" value="0" />
      <fieldset class="module aligned">
        <h2>Στοιχεία εκπαιδευτικού</h2>
        <div class="form-row field-lastname">
          <div>
            <label style="width:220px;">Επώνυμο : </label>
            <p>{{ emp.lastname  }}</p>
          </div>
        </div>
        <div class="form-row field-firstname">
          <div>
            <label style="width:220px;">Όνομα : </label>
            <p>{{ emp.firstname  }}</p>
          </div>
      </div>
      <div class="form-row field-fathername">
        <div>
          <label style="width:220px;">Πατρώνυμο : </label>
            <p>{{ emp.fathername  }}</p>
        </div>
      </div>
      <div class="form-row field-profession">
        <div>
          <label style="width:220px;">Ειδικότητα : </label>
          <p>{{ emp.profession  }}</p>
        </div>
      </div>
	{% if emp.registration_number %}
	<div class="form-row field-registration_number">
        <div>
          <label style="width:220px;">Αριθμός Μητρώου : </label>
          <p>{{ emp.registration_number  }}</p>
        </div>
      </div>
	{% endif %}
	{% if emp.vat_number and not emp.registration_number %}
	<div class="form-row field-rank">
        <div>
          <label style = "width:220px;">Α.Φ.Μ.: </label>
          <p>{{ emp.vat_number  }}</p>
        </div>
      </div>
	{% endif %}
	{% if emp.rank %}
	<div class="form-row field-rank">
        <div>
          <label style = "width:220px;">Βαθμός - Κλιμάκιο: </label>
          <p>{{ emp.rank  }} (από {{ emp.rank_date  }}) </p>
        </div>
      </div>
	{% endif %}
 	<div style="text-align: left;  width: 100%; height: 25px; margin: 0; background: #7CA0C7 url({% static "admin/img/default-bg.gif" %}) top left repeat-x; color: white;">
 	<div style="text-align: left; float: left; width: 60%; margin: 0; padding: 5px 5px 3px 5px; font-size: 11px; font-weight: bold; color: white;">
 		Αποδοχές
 	</div>
 	<div style="text-align: right; float: right; width: 30%; margin: 0; padding: 0px 3px 0px 5px; font-size: 11px; font-weight: bold; color: white; ">
 		<select id="totalreports" style="font-size: 11px; font-family: 'Lucida Grande΄', Verdana, Arial, sans-serif;">
        	<option value="0" selected="">Έκδοση συγκεντρωτικής...</option>
      		{% for opt in yearly_reports %}
      		<option value="{{opt}}">Μισθοδοτικής κατάστασης {{opt}}</option>
      		{% endfor %}
      	</select>
  	</div>
  	</div>
      {% if payments %}
        <div style="height: 300px;">
            <table summary="Αποδοχές" style="width:100%">
              <tbody>
                <tr>
                  <th>Περιγραφή </th>
                  <th>Βαθμός - Κλιμάκιο</th>
                  <th>Αποδοχές</th>
				</tr>
                {% for p in payments %}
                  <tr>
                    <td scope="row"><a href="?print=1&id={{ p.id }} "> {{ p.type }} {{ p.year }}</a></td>
                    <td>{% if p.rank %} {{ p.rank }} {% else %} Δ/Υ {% endif %}</td>
                    <td>
					{% if p.netab_amount == 0 %}
						{{ p.calc_amount }} €
					{% else %}
						{{ p.netab_amount }} €
					{% endif %}
					</td>
			      </tr>
                {% endfor %}
              </tbody>
            </table>
      </div>
      {% else %}
        <div style="height: 300px;" class="form-row"><p>Δεν έχουν καταχωρηθεί καταστάσεις πληρωμών.</p></div>
      {% endif %}
	  
    </fieldset>
  </form>
</div>
{% endblock %}

